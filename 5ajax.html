<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ajax</title>
</head>
<body>
<script>
    function extend (dst, obj) {
        for (var i in obj) {
            if (obj.hasOwnProperty(i)) {
                dst[i] = obj[i];
            }
        }
    }

    function getName (prefix) {
        return prefix + Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 5);
    }

    function jsonAjax (option) {
        var opt = {
            'type': 'GET',
            'url': '',
            'data': {},
            'success': function (res) {
                alert(1)
                res = JSON.parse(res);
                console.log(JSON.stringify(res, null, '   '));
            },
            'error': function (res) {
                res = JSON.parse(res);
                console.log(JSON.stringify(res, null, '   '));
            }
        };
        extend(opt, option);
        var xhr = XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
        var type = opt.type.toUpperCase();
        var data = opt.data, dataArr = [];
        for (var k in data) {
            dataArr.push(k + '=' + data[k]);
        }
        debugger
        if (opt.url) {
            var url = opt.url;
            if (type === 'GET') {
                url += '?' + dataArr.join('&');
            }
            if (type === 'POST') {
                xhr.setRequestHeader('Content-Type', 'application/json');
            }
            xhr.open(type, url, true);
            xhr.onreadystatechange = function () {
                console.log(xhr.status)
                if (xhr.status === 200 || xhr.status === 304) {
                    alert(2)
                    opt.success(xhr.response);
                } else {
                    opt.error(xhr.response);
                }
            };
            xhr.send(type === 'POST' ? dataArr.join('&') : null);
        }
    }
</script>

</body>
</html>